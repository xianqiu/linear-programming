---
weight: 712
title: "直接求解"
description: ""
icon: "article"
date: "2025-04-21T11:18:50+08:00"
lastmod: "2025-04-21T11:18:50+08:00"
draft: false
toc: true
katex: true
---

这是 [下料问题](cutting-stock) 的整数规划模型。

{{<katex>}}
$$
\begin{aligned}
\min ~ & \sum_{j=1}^n x_j \\
\text{ s.t. } &  \sum_{j=1}^n a_{i,j} x_j = d_i, ~\forall i \\
& x_j \in \mathbb{N}_+, ~\forall j
\end{aligned}
$$
{{</katex>}}

接下来对它进行求解。

### 精确解

最直接的办法，就是用整数规划求解器。但是有个问题，当问题规模较大时，求解器可能算不出来。因为整数规划问题的计算复杂度很高。

简单分析一下问题的规模。令 $m$ 代表产品类型数量，$n$ 代表可行切割方式的数量。在上面的规划中，约束的个数是 $m$，变量的个数是 $n$。在最坏的情况下，$n$ 随着 $m$ 的增大呈指数增长，即 $n\geq 2^m$。换句话说，变量的数量随着 $m$ 程指数增长。即便是求解它的松弛问题，即线性规划问题，当 $m$ 较大时，其时间复杂度的增长也是指数型的。

在这个例子中 $m=4$，我们可以尝试精确求解。

### 近似解

另一个思路是求近似解。目标是求一个可行解，尽可能地靠近最优解，但是计算计算效率要高。思路是先计算松弛问题的最优解，再把这个解转化成一个可行解。

具体来说，有四个步骤。

**第一步，求解松弛问题**

{{<katex>}}
$$
\begin{aligned}
\min ~ & \sum_{j=1}^n x_j \\
\text{ s.t. } &  \sum_{j=1}^n a_{i,j} x_j = d_i, ~\forall i  \\
& x_j \geq 0, ~\forall j
\end{aligned}
$$
{{</katex>}}

它的最优解记作 $x^*$。

**第二步，向下取整**

把最优解 $x^\*$ 向下取整，得到整数解记作 $\bar{x}= \lfloor x^* \rfloor$。但是取整后，可能导致需求不满足，即

$$
\sum_{j=1}^n a_{ij}\bar{x}_j < d_i,\quad \exists~ i
$$

因此，需要计算没有被满足的需求量。为了方便描述，用 $r_i$ 来表示

$$
r_i = d_i - \sum_{j=1}^n a_{ij}\bar{x}_j, \quad \forall i
$$

接下来满足剩余的需求。

**第三步，满足需求**

考虑所有 $\set{r_i \mid r_i > 0}$。把 $r_i$ 从大到小排列，记作 $r_{i_1}, r_{i_2}, ...r_{i_q}$，然后依次满足需求。注意：$q\leq m$，在这个例子中 $m=4$。

具体来说，从第 $r_{i_1}$ 开始。 表示第 $i_1$ 种产品，它的需求长度是 $s_{i_1}$，需求量是 $r_{i_1}$。

考虑一根原材料，对它按长度 $s_{i_1}$ 切割，对应的切割向量记作 $b_{i_1}$，那么一根原材料能满足需求量为 $k_{i_1} = \lfloor L / s_{i_1} \rfloor$。因此，一共需要 $y_{i_1} :=\lceil r_{i_1} / k_{i_1}\rceil$ 即可满足产品 $i_1$ 的需求量 $r_{i_1}$。

接下来考虑 $r_{i_2}, r_{i_3}, ..., r_{i_q}$。

**第四步，得到可行解**

实际上，在第三步已经得到了可行解。它包含两个部分，一部分来自 $\bar{x}$，令一个部分来自 $y_{i_1}, y_{i_2}, ..., y_{i_q}$。但是从形式上，需要把它们整合在一起，从而方便计算需要的原材料数量以及对应的切割方式。

考虑所有的 {{<katex>}}$\set{\bar{x}_j > 0}${{</katex>}}，记作 $x_{j_1}, x_{j_2}, ..., x_{j_p}$，$p$ 代表 $\bar{x}$ 中非零分量的数量。那么 $a_{j_1}, a_{j_2}, ..., a_{j_p}$ 代表对应的切割方式。

我们得到下面的可行解，用向量 $z$ 和可行矩阵 $C$ 来描述。

{{<katex>}}
$$
\begin{aligned}
& \begin{aligned}
z & = [z_1, z_2, ..., z_{p+q}]\\
  & = [x_{j_1}, ..., x_{j_p},  y_{i_1}, ..., y_{i_q}]
\end{aligned}\\
& C = [a_{j_1}, ..., a_{j_p},  b_{i_1}, ..., b_{i_q}]
\end{aligned}
$$
{{</katex>}}

其中 $z$ 代表每一种切割方式对应的原材料数量，那么总原材料数量就是 $\sum_{j=1}^{p+q} z_j$；矩阵 $C$ 的列代表对应的切割方式。

### 问题

求近似解的过程中，求解松弛问题虽然比整数规划容易，但是仍然不能处理大规模的情形。即，当 $m$ 较大时，$n$ 是 $m$ 的指数关系，导致系数矩阵 $A$ 非常大。在这种情况下，即是解线性规划问题，求解效率仍然不高。

